# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-09-25 16:31:40
"""
from abc import abstractproperty
import bxarcpy


def main(工作空间=r"C:\Users\common\project\J江东区临江控规\临江控规_数据库.gdb", 区域要素名称="JX_街区范围线", 单元名称="临江单元", 层级="街区", 输出要素名称="XG_JQJF_JQ"):
    with bxarcpy.环境.环境管理器(临时工作空间=工作空间, 工作空间=工作空间):
        # To allow overwriting outputs change overwriteOutput option to True.
        bxarcpy.配置.是否覆盖输出要素 = True
        print(f"当前层级是：{层级}")
        区域要素 = bxarcpy.要素类.要素读取_通过名称(区域要素名称)
        区域要素 = 区域要素.要素创建_通过复制()

        区域要素.字段添加("DYMC", "字符串", 50, "规划编制单元名称").字段计算("DYMC", f"'{单元名称}'")
        区域要素.字段添加("CJ", "字符串", 10, "层级").字段计算("CJ", f"'{层级}'")
        区域要素.字段添加("BM", "字符串", 10, "编码").字段计算("BM", f"!区域编号!")
        区域要素.字段添加("LX", "字符串", 10, "类型").字段计算("LX", f"!区域主导属性!")
        区域要素.字段添加("MJ", "双精度", 50, "面积").字段计算("MJ", "round(!Shape_Area!/10000, 2)")
        区域要素.字段添加("RK", "双精度", 50, f"{层级}人口规模").字段计算("RK", "round(float(!总居住人数!)/10000,2)")
        区域要素.字段添加("JZZL", "双精度", 50, f"{层级}建筑总量").字段计算("JZZL", "round(float(!总建筑面积!)/10000,2)")
        区域要素.字段添加("ZZZL", "双精度", 50, f"{层级}住宅总建筑面积").字段计算("ZZZL", "round(float(!总住宅建筑面积!)/10000,2)")
        区域要素.字段添加("GYZL", "双精度", 50, f"{层级}工业总建筑面积").字段计算("GYZL", "round(float(!总工业建筑面积!)/10000,2)")
        区域要素.字段添加("SYZL", "双精度", 50, f"{层级}商业商务总建筑面积").字段计算("SYZL", "round(float(!总商服建筑面积!)/10000,2)")
        区域要素.字段添加("BZ", "字符串", 255, "备注")

        区域要素.字段删除(保留字段名称列表=["DYMC", "CJ", "BM", "LX", "MJ", "RK", "JZZL", "ZZZL", "GYZL", "SYZL", "BZ"])

        区域要素.要素创建_通过复制并重命名重名要素(输出要素名称)


if __name__ == "__main__":
    # main(工作空间=r"C:\Users\common\project\J江东区临江控规\临江控规_数据库.gdb", 街区要素名称="JX_街区范围线", 单元名称="临江单元", 用地规划图要素名称="DIST_用地规划图", 层级="街区")
    # main(工作空间=r"C:\Users\common\project\J江东区临江控规\临江控规_数据库.gdb", 区域要素名称="JX_街坊范围线", 单元名称="临江单元", 层级="街坊", 输出要素名称="XG_JQJF_JF")
    main(工作空间=r"C:\Users\common\project\F富阳受降控规\受降北_数据库.gdb", 区域要素名称="JX_街坊范围线", 单元名称="受降北单元", 层级="街坊", 输出要素名称="XG_JQJF_JF")
